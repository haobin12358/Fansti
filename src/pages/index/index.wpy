<style lang="less">
  @import "../../styles/base";

  .container  {

    .swiper{
      height: 401rpx;

      swiper-item{
        image{
          width: 100%;
          height: 100%;
        }
      }
    }
  }
</style>
<template>
  <view class="container">
    <swiper class="swiper">
      <swiper-item>
        <image src="../../images/test_swiper.png"></image>
      </swiper-item>
    </swiper>
  </view>
  <news-list :list.sync="newsList" @tapItem.user="goNewsDetail"></news-list>
</template>

<script>
  import wepy from 'wepy'
  import NewsList from '@/components/newsList'
  import api from '@/api/api';
  import tip from '@/utils/tip';

  export default class Index extends wepy.page {
    config = {
      navigationBarTitleText: 'test'
    }

    components = {
      'news-list': NewsList
    }

    data={
      newsList: []
    }

    methods={
      goNewsDetail(news){
        this.$navigate('/pages/index/newsDetail', news)
      }
    }

    async getAllNews(){
      let res = await api.getAllNews();

      if (res.data.status == 200) {
        this.newsList = res.data.data;
        this.$apply();
      } else {
        tip.alert(res.data.message);
      }
    }

    onLoad(){
      this.getAllNews();
    }

  }
</script>
